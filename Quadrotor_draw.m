function Quadrotor_draw(uu,P)
    % process inputs to function
    x_       = uu(1);       % inertial North position     
    y_       = uu(2);       % inertial East position
    z_       = uu(3);           
    u        = uu(4);   %
    v        = uu(5);     % pitch angle   
    w        = uu(6);       % yaw angle 
    phi      =uu(7);               
    theta    =uu(8);            
    psi      =uu(9);           
    p        = uu(10);       % roll rate
    q        = uu(11);       % pitch rate     
    r        = uu(12);       % yaw rate    
    t        = uu(13);       % time

    % define persistent variables 
    persistent vehicle_handle;
    persistent Vertices
    persistent Faces
    persistent facecolors
    persistent scale
    
    

    % first time function is called, initialize plot and persistent vars
    if t==0,

    
        [Vertices,Faces,facecolors] = defineVehicleBody;
        vehicle_handle = drawVehicleBody(Vertices,Faces,facecolors,...
                                               y_,x_,z_,phi,theta,psi,...
                                               [],'normal');
        title('Vehicle')
        xlabel('Norte')
        ylabel('Este')
        zlabel('Altura')
        view(32,47)  % set the vieew angle for figure
    else 
%         hold on
%         %plot3(pe,pn,-pd,'r.');
%          plot3(pe,pn,-pd,'r.','LineWidth',0.1);
        drawVehicleBody(Vertices,Faces,facecolors,...
                           y_,x_,z_,phi,theta,psi,...
                           vehicle_handle);        
    end
end

  
%=======================================================================
% drawVehicle
% return handle if 3rd argument is empty, otherwise use 3rd arg as handle
%=======================================================================
%
function handle = drawVehicleBody(V,F,patchcolors,...
                                     pn,pe,pd,phi,theta,psi,...
                                     handle,mode)

  V = rotate(V, phi, theta, psi);  % rotate vehicle
  V = translate(V, pn, pe, pd);  % translate vehicle
  

  % transform vertices from NED to XYZ (for matlab rendering)
  R = [...
      0, 1, 0;...
      1, 0, 0;...
      0, 0, -1;...
      ];
  V = R*V;
  %plot3(pn,pe,pd,'r');
  if isempty(handle),
  handle = patch('Vertices', V', 'Faces', F,...
                 'FaceVertexCData',patchcolors,...
                 'FaceColor','flat',...
                 'EraseMode', mode);
  else
    set(handle,'Vertices',V','Faces',F);
%     xlim(handle.Parent,[pe-3, pe+3]);
%     ylim(handle.Parent,[pn-3, pn+3]);
%     zlim(handle.Parent,[-(pd+1.5), -(pd-1.5)]);
    drawnow
  end
end

%%%%%%%%%%%%%%%%%%%%%%%
function pts=rotate(pts,phi,theta,psi)

  % define rotation matrix (right handed)
  R_roll = [...
          1, 0, 0;...
          0, cos(phi), sin(phi);...
          0, -sin(phi), cos(phi)];
  R_pitch = [...
          cos(theta), 0, -sin(theta);...
          0, 1, 0;...
          sin(theta), 0, cos(theta)];
  R_yaw = [...
          cos(psi), sin(psi), 0;...
          -sin(psi), cos(psi), 0;...
          0, 0, 1];
  R = R_roll*R_pitch*R_yaw;  
    % note that R above either leaves the vector alone or rotates
    % a vector in a left handed rotation.  We want to rotate all
    % points in a right handed rotation, so we must transpose
  R = R';

  % rotate vertices
  pts = R*pts;
  
end
% end rotateVert

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% translate vertices by pn, pe, pd
function pts = translate(pts,pn,pe,pd)

  pts = pts + repmat([pn;pe;pd],1,size(pts,2));
    
end

% end translate


%=======================================================================
% defineVehicleBody
%=======================================================================
function [V,F,facecolors] = defineVehicleBody
%scale=1;
 
scale=2.5;

l_body = 0.15;
h_body = 0.05;
l_arm = 0.25;
h_arm= 0.04;
h_motor=0.03;
r_motor=0.02;
[xm,ym,zm] = cylinder(r_motor,15);
xp=xm*5;
yp=ym*5;
% Define the vertices (physical location of verti   ces
V = scale*[...
    %body
    l_body/2,l_body/2 , -h_body;...   % pt 1
    -l_body/2,l_body/2 , -h_body;... % pt 2
    -l_body/2,-l_body/2 , -h_body;...   % pt 3
    l_body/2,-l_body/2 , -h_body;...  % pt 4
    l_body/2,l_body/2 , 0;...   % pt 5
    -l_body/2,l_body/2 , 0;... % pt 6
    -l_body/2,-l_body/2 , 0;...   % pt 7
    l_body/2,-l_body/2 , 0  % pt 8
    %arm1
    0, -h_arm/2, -(h_body/2 + h_arm/4);...% pt 9
    l_arm-r_motor,-h_arm/2, -(h_body/2 + h_arm/4);...% pt 10
    l_arm-r_motor,h_arm/2,-(h_body/2 + h_arm/4);...% pt 11
    0,h_arm/2,-(h_body/2 + h_arm/4);...% pt 12
    0,-h_arm/2,-(h_body/2 - h_arm/4);...% pt 13
    l_arm-r_motor,-h_arm/2,-(h_body/2 - h_arm/4);...% pt 14
    l_arm-r_motor,h_arm/2,-(h_body/2 - h_arm/4);...% pt 15
    0,h_arm/2,-(h_body/2 - h_arm/4);...% pt 16
%     %arm2
    h_arm/2,0,-(h_body/2 + h_arm/4);...  % pt 17
    h_arm/2, l_arm-r_motor, -(h_body/2 + h_arm/4);... % pt 18
    -h_arm/2, l_arm-r_motor, -(h_body/2 + h_arm/4);... % pt 19
    -h_arm/2,0, -(h_body/2 + h_arm/4);... % pt 20
    h_arm/2, 0, -(h_body/2 - h_arm/4);... % pt 21
    h_arm/2, l_arm-r_motor, -(h_body/2 - h_arm/4);... % pt 22
    -h_arm/2, l_arm-r_motor,-(h_body/2 - h_arm/4);... % pt 23
    -h_arm/2,0, -(h_body/2 - h_arm/4);...  % pt 24
%     %arm3
    0,h_arm/2, -(h_body/2 + h_arm/4);...  % pt 25
    -l_arm+r_motor, h_arm/2,-(h_body/2 + h_arm/4);...  % pt 26
    -l_arm+r_motor, -h_arm/2, -(h_body/2 + h_arm/4);...  % pt 27
    0,-h_arm/2, -(h_body/2 + h_arm/4);...  % pt 28
    0,h_arm/2, -(h_body/2 - h_arm/4);...  % pt 29
    -l_arm+r_motor, h_arm/2, -(h_body/2 - h_arm/4);...  % pt 30
    -l_arm+r_motor, -h_arm/2, -(h_body/2 - h_arm/4);...  % pt 31
    0,-h_arm/2, -(h_body/2 - h_arm/4);...  % pt 32
%     %arm4
    -h_arm/2, 0,-(h_body/2 + h_arm/4);... % pt 33
    -h_arm/2, -l_arm+r_motor,-(h_body/2 + h_arm/4);... % pt 34
    h_arm/2, -l_arm+r_motor, -(h_body/2 + h_arm/4);... % pt 35
    h_arm/2, 0,-(h_body/2 + h_arm/4);... % pt 36
    -h_arm/2, 0, -(h_body/2 - h_arm/4);... % pt 37
    -h_arm/2, -l_arm+r_motor, -(h_body/2 - h_arm/4);... % pt 38
    h_arm/2, -l_arm+r_motor, -(h_body/2 - h_arm/4);... % pt 39
    h_arm/2, 0, -(h_body/2 - h_arm/4);... % pt 40
    %motor1
    l_arm-r_motor+xm(1,1), ym(1,1), -(h_body/2-h_arm/4);... %41
    l_arm-r_motor+xm(1,2), ym(1,2), -(h_body/2-h_arm/4);...  %42
    l_arm-r_motor+xm(1,3), ym(1,3), -(h_body/2-h_arm/4);...  %43
    l_arm-r_motor+xm(1,4), ym(1,4), -(h_body/2-h_arm/4);... %44
    l_arm-r_motor+xm(1,5), ym(1,5), -(h_body/2-h_arm/4);... %45
    l_arm-r_motor+xm(1,6), ym(1,6), -(h_body/2-h_arm/4);... %46
    l_arm-r_motor+xm(1,7), ym(1,7), -(h_body/2-h_arm/4);... %47
    l_arm-r_motor+xm(1,8), ym(1,8), -(h_body/2-h_arm/4);... %48
    l_arm-r_motor+xm(1,9), ym(1,9), -(h_body/2-h_arm/4);... %49
    l_arm-r_motor+xm(1,10), ym(1,10), -(h_body/2-h_arm/4);... %50
    l_arm-r_motor+xm(1,11), ym(1,11), -(h_body/2-h_arm/4);... %51
    l_arm-r_motor+xm(1,12), ym(1,12),-(h_body/2-h_arm/4);... %52
    l_arm-r_motor+xm(1,13), ym(1,13), -(h_body/2-h_arm/4);... %53
    l_arm-r_motor+xm(1,14), ym(1,14), -(h_body/2-h_arm/4);... %54
    l_arm-r_motor+xm(1,15), ym(1,15), -(h_body/2-h_arm/4);... %55
    l_arm-r_motor+xm(1,1), ym(1,1), -(h_body/2+h_arm/4+h_motor);... %56
    l_arm-r_motor+xm(1,2), ym(1,2), -(h_body/2+h_arm/4+h_motor);...  %57
    l_arm-r_motor+xm(1,3), ym(1,3), -(h_body/2+h_arm/4+h_motor);...  %58
    l_arm-r_motor+xm(1,4), ym(1,4), -(h_body/2+h_arm/4+h_motor);... %59
    l_arm-r_motor+xm(1,5), ym(1,5), -(h_body/2+h_arm/4+h_motor);... %60
    l_arm-r_motor+xm(1,6), ym(1,6), -(h_body/2+h_arm/4+h_motor);... %61
    l_arm-r_motor+xm(1,7), ym(1,7), -(h_body/2+h_arm/4+h_motor);... %62
    l_arm-r_motor+xm(1,8), ym(1,8), -(h_body/2+h_arm/4+h_motor);... %63
    l_arm-r_motor+xm(1,9), ym(1,9), -(h_body/2+h_arm/4+h_motor);... %64
    l_arm-r_motor+xm(1,10), ym(1,10), -(h_body/2+h_arm/4+h_motor);... %65
    l_arm-r_motor+xm(1,11), ym(1,11), -(h_body/2+h_arm/4+h_motor);... %66
    l_arm-r_motor+xm(1,12), ym(1,12), -(h_body/2+h_arm/4+h_motor);... %67
    l_arm-r_motor+xm(1,13), ym(1,13), -(h_body/2+h_arm/4+h_motor);... %68
    l_arm-r_motor+xm(1,14), ym(1,14), -(h_body/2+h_arm/4+h_motor);... %69
    l_arm-r_motor+xm(1,15), ym(1,15), -(h_body/2+h_arm/4+h_motor);... %70
    %motor2
    xm(1,1), l_arm-r_motor+ym(1,1), -(h_body/2-h_arm/4);... %71
    xm(1,2), l_arm-r_motor+ym(1,2), -(h_body/2-h_arm/4);...  %72
    xm(1,3), l_arm-r_motor+ym(1,3), -(h_body/2-h_arm/4);...  %73
    xm(1,4), l_arm-r_motor+ym(1,4), -(h_body/2-h_arm/4);... %74
    xm(1,5), l_arm-r_motor+ym(1,5), -(h_body/2-h_arm/4);... %75
    xm(1,6), l_arm-r_motor+ym(1,6), -(h_body/2-h_arm/4);... %76
    xm(1,7), l_arm-r_motor+ym(1,7), -(h_body/2-h_arm/4);... %77
    xm(1,8), l_arm-r_motor+ym(1,8), -(h_body/2-h_arm/4);... %78
    xm(1,9), l_arm-r_motor+ym(1,9), -(h_body/2-h_arm/4);... %79
    xm(1,10), l_arm-r_motor+ym(1,10), -(h_body/2-h_arm/4);... %80
    xm(1,11), l_arm-r_motor+ym(1,11), -(h_body/2-h_arm/4);... %81
    xm(1,12), l_arm-r_motor+ym(1,12), -(h_body/2-h_arm/4);... %82
    xm(1,13), l_arm-r_motor+ym(1,13), -(h_body/2-h_arm/4);... %83
    xm(1,14), l_arm-r_motor+ym(1,14), -(h_body/2-h_arm/4);... %84
    xm(1,15), l_arm-r_motor+ym(1,15), -(h_body/2-h_arm/4);... %85
    xm(1,1), l_arm-r_motor+ym(1,1), -(h_body/2+h_arm/4+h_motor);... %86    
    xm(1,2), l_arm-r_motor+ym(1,2), -(h_body/2+h_arm/4+h_motor);...  %87   
    xm(1,3), l_arm-r_motor+ym(1,3), -(h_body/2+h_arm/4+h_motor);...  %88   
    xm(1,4), l_arm-r_motor+ym(1,4), -(h_body/2+h_arm/4+h_motor);... %89   
    xm(1,5), l_arm-r_motor+ym(1,5), -(h_body/2+h_arm/4+h_motor);... %90
    xm(1,6), l_arm-r_motor+ym(1,6), -(h_body/2+h_arm/4+h_motor);... %91
    xm(1,7), l_arm-r_motor+ym(1,7), -(h_body/2+h_arm/4+h_motor);... %92
    xm(1,8), l_arm-r_motor+ym(1,8), -(h_body/2+h_arm/4+h_motor);... %93
    xm(1,9), l_arm-r_motor+ym(1,9), -(h_body/2+h_arm/4+h_motor);... %94
    xm(1,10), l_arm-r_motor+ym(1,10), -(h_body/2+h_arm/4+h_motor);... %95
    xm(1,11), l_arm-r_motor+ym(1,11), -(h_body/2+h_arm/4+h_motor);... %96
    xm(1,12), l_arm-r_motor+ym(1,12), -(h_body/2+h_arm/4+h_motor);... %97
    xm(1,13), l_arm-r_motor+ym(1,13), -(h_body/2+h_arm/4+h_motor);... %98
    xm(1,14), l_arm-r_motor+ym(1,14), -(h_body/2+h_arm/4+h_motor);... %99
    xm(1,15), l_arm-r_motor+ym(1,15), -(h_body/2+h_arm/4+h_motor);... %100
    %motor3
    -(l_arm-r_motor)+xm(1,1), ym(1,1), -(h_body/2-h_arm/4);... %101
    -(l_arm-r_motor)+xm(1,2), ym(1,2), -(h_body/2-h_arm/4);...  %102
    -(l_arm-r_motor)+xm(1,3), ym(1,3), -(h_body/2-h_arm/4);...  %103
    -(l_arm-r_motor)+xm(1,4), ym(1,4), -(h_body/2-h_arm/4);... %104
    -(l_arm-r_motor)+xm(1,5), ym(1,5), -(h_body/2-h_arm/4);... %105
    -(l_arm-r_motor)+xm(1,6), ym(1,6), -(h_body/2-h_arm/4);... %106
    -(l_arm-r_motor)+xm(1,7), ym(1,7), -(h_body/2-h_arm/4);... %107
    -(l_arm-r_motor)+xm(1,8), ym(1,8), -(h_body/2-h_arm/4);... %108
    -(l_arm-r_motor)+xm(1,9), ym(1,9), -(h_body/2-h_arm/4);... %109
    -(l_arm-r_motor)+xm(1,10), ym(1,10), -(h_body/2-h_arm/4);... %110
    -(l_arm-r_motor)+xm(1,11), ym(1,11), -(h_body/2-h_arm/4);... %111
    -(l_arm-r_motor)+xm(1,12), ym(1,12), -(h_body/2-h_arm/4);... %112
    -(l_arm-r_motor)+xm(1,13), ym(1,13), -(h_body/2-h_arm/4);... %113
    -(l_arm-r_motor)+xm(1,14), ym(1,14), -(h_body/2-h_arm/4);... %114
    -(l_arm-r_motor)+xm(1,15), ym(1,15), -(h_body/2-h_arm/4);... %115
    -(l_arm-r_motor)+xm(1,1), ym(1,1), -(h_body/2+h_arm/4+h_motor);... %116
    -(l_arm-r_motor)+xm(1,2), ym(1,2), -(h_body/2+h_arm/4+h_motor);...  %117
    -(l_arm-r_motor)+xm(1,3), ym(1,3), -(h_body/2+h_arm/4+h_motor);...  %118
    -(l_arm-r_motor)+xm(1,4), ym(1,4), -(h_body/2+h_arm/4+h_motor);... %119
    -(l_arm-r_motor)+xm(1,5), ym(1,5), -(h_body/2+h_arm/4+h_motor);... %120
    -(l_arm-r_motor)+xm(1,6), ym(1,6), -(h_body/2+h_arm/4+h_motor);... %121
    -(l_arm-r_motor)+xm(1,7), ym(1,7), -(h_body/2+h_arm/4+h_motor);... %122
    -(l_arm-r_motor)+xm(1,8), ym(1,8), -(h_body/2+h_arm/4+h_motor);... %123
    -(l_arm-r_motor)+xm(1,9), ym(1,9), -(h_body/2+h_arm/4+h_motor);... %124
    -(l_arm-r_motor)+xm(1,10), ym(1,10), -(h_body/2+h_arm/4+h_motor);... %125
    -(l_arm-r_motor)+xm(1,11), ym(1,11), -(h_body/2+h_arm/4+h_motor);... %126
    -(l_arm-r_motor)+xm(1,12), ym(1,12), -(h_body/2+h_arm/4+h_motor);... %127
    -(l_arm-r_motor)+xm(1,13), ym(1,13), -(h_body/2+h_arm/4+h_motor);... %128
    -(l_arm-r_motor)+xm(1,14), ym(1,14), -(h_body/2+h_arm/4+h_motor);... %129
    -(l_arm-r_motor)+xm(1,15), ym(1,15), -(h_body/2+h_arm/4+h_motor);... %130
    %motor4
    xm(1,1), -(l_arm-r_motor)+ym(1,1), -(h_body/2-h_arm/4);... %131
    xm(1,2), -(l_arm-r_motor)+ym(1,2), -(h_body/2-h_arm/4);...  %132
    xm(1,3), -(l_arm-r_motor)+ym(1,3), -(h_body/2-h_arm/4);...  %133
    xm(1,4), -(l_arm-r_motor)+ym(1,4), -(h_body/2-h_arm/4);... %134
    xm(1,5), -(l_arm-r_motor)+ym(1,5), -(h_body/2-h_arm/4);... %135
    xm(1,6), -(l_arm-r_motor)+ym(1,6), -(h_body/2-h_arm/4);... %136
    xm(1,7), -(l_arm-r_motor)+ym(1,7), -(h_body/2-h_arm/4);... %137
    xm(1,8), -(l_arm-r_motor)+ym(1,8), -(h_body/2-h_arm/4);... %138
    xm(1,9), -(l_arm-r_motor)+ym(1,9), -(h_body/2-h_arm/4);... %139
    xm(1,10), -(l_arm-r_motor)+ym(1,10), -(h_body/2-h_arm/4);... %140
    xm(1,11), -(l_arm-r_motor)+ym(1,11), -(h_body/2-h_arm/4);... %141
    xm(1,12), -(l_arm-r_motor)+ym(1,12), -(h_body/2-h_arm/4);... %142
    xm(1,13), -(l_arm-r_motor)+ym(1,13), -(h_body/2-h_arm/4);... %143
    xm(1,14), -(l_arm-r_motor)+ym(1,14), -(h_body/2-h_arm/4);... %144
    xm(1,15), -(l_arm-r_motor)+ym(1,15), -(h_body/2-h_arm/4);... %145
    xm(1,1), -(l_arm-r_motor)+ym(1,1), -(h_body/2+h_arm/4+h_motor);... %146  
    xm(1,2), -(l_arm-r_motor)+ym(1,2), -(h_body/2+h_arm/4+h_motor);...  %147   
    xm(1,3), -(l_arm-r_motor)+ym(1,3), -(h_body/2+h_arm/4+h_motor);...  %148  
    xm(1,4), -(l_arm-r_motor)+ym(1,4), -(h_body/2+h_arm/4+h_motor);... %149   
    xm(1,5), -(l_arm-r_motor)+ym(1,5), -(h_body/2+h_arm/4+h_motor);... %150
    xm(1,6), -(l_arm-r_motor)+ym(1,6), -(h_body/2+h_arm/4+h_motor);... %151
    xm(1,7), -(l_arm-r_motor)+ym(1,7), -(h_body/2+h_arm/4+h_motor);... %152
    xm(1,8), -(l_arm-r_motor)+ym(1,8), -(h_body/2+h_arm/4+h_motor);... %153
    xm(1,9), -(l_arm-r_motor)+ym(1,9), -(h_body/2+h_arm/4+h_motor);... %154
    xm(1,10), -(l_arm-r_motor)+ym(1,10), -(h_body/2+h_arm/4+h_motor);... %155
    xm(1,11), -(l_arm-r_motor)+ym(1,11), -(h_body/2+h_arm/4+h_motor);... %156
    xm(1,12), -(l_arm-r_motor)+ym(1,12), -(h_body/2+h_arm/4+h_motor);... %157
    xm(1,13), -(l_arm-r_motor)+ym(1,13), -(h_body/2+h_arm/4+h_motor);... %158
    xm(1,14), -(l_arm-r_motor)+ym(1,14), -(h_body/2+h_arm/4+h_motor);... %159
    xm(1,15), -(l_arm-r_motor)+ym(1,15), -(h_body/2+h_arm/4+h_motor);... %160
    %propeller 1
    l_arm-r_motor+xp(1,1), yp(1,1), -(h_body/2+h_arm/4+h_motor);... %161
    l_arm-r_motor+xp(1,2), yp(1,2), -(h_body/2+h_arm/4+h_motor);...  %162
    l_arm-r_motor+xp(1,3), yp(1,3), -(h_body/2+h_arm/4+h_motor);...  %163
    l_arm-r_motor+xp(1,4), yp(1,4), -(h_body/2+h_arm/4+h_motor);... %164
    l_arm-r_motor+xp(1,5), yp(1,5), -(h_body/2+h_arm/4+h_motor);... %165
    l_arm-r_motor+xp(1,6), yp(1,6), -(h_body/2+h_arm/4+h_motor);... %166
    l_arm-r_motor+xp(1,7), yp(1,7), -(h_body/2+h_arm/4+h_motor);... %167
    l_arm-r_motor+xp(1,8), yp(1,8), -(h_body/2+h_arm/4+h_motor);... %168
    l_arm-r_motor+xp(1,9), yp(1,9), -(h_body/2+h_arm/4+h_motor);... %169
    l_arm-r_motor+xp(1,10), yp(1,10), -(h_body/2+h_arm/4+h_motor);... %170
    l_arm-r_motor+xp(1,11), yp(1,11), -(h_body/2+h_arm/4+h_motor);... %171
    l_arm-r_motor+xp(1,12), yp(1,12), -(h_body/2+h_arm/4+h_motor);... %172
    l_arm-r_motor+xp(1,13), yp(1,13), -(h_body/2+h_arm/4+h_motor);... %173
    l_arm-r_motor+xp(1,14), yp(1,14), -(h_body/2+h_arm/4+h_motor);... %174
    l_arm-r_motor+xp(1,15), yp(1,15), -(h_body/2+h_arm/4+h_motor);... %175
    %propeller 2
    xp(1,1), l_arm-r_motor+yp(1,1), -(h_body/2+h_arm/4+h_motor);... %176    
    xp(1,2), l_arm-r_motor+yp(1,2), -(h_body/2+h_arm/4+h_motor);...  %177   
    xp(1,3), l_arm-r_motor+yp(1,3), -(h_body/2+h_arm/4+h_motor);...  %178   
    xp(1,4), l_arm-r_motor+yp(1,4), -(h_body/2+h_arm/4+h_motor);... %179   
    xp(1,5), l_arm-r_motor+yp(1,5), -(h_body/2+h_arm/4+h_motor);... %180
    xp(1,6), l_arm-r_motor+yp(1,6), -(h_body/2+h_arm/4+h_motor);... %181
    xp(1,7), l_arm-r_motor+yp(1,7), -(h_body/2+h_arm/4+h_motor);... %182
    xp(1,8), l_arm-r_motor+yp(1,8), -(h_body/2+h_arm/4+h_motor);... %183
    xp(1,9), l_arm-r_motor+yp(1,9), -(h_body/2+h_arm/4+h_motor);... %184
    xp(1,10), l_arm-r_motor+yp(1,10), -(h_body/2+h_arm/4+h_motor);... %185
    xp(1,11), l_arm-r_motor+yp(1,11), -(h_body/2+h_arm/4+h_motor);... %186
    xp(1,12), l_arm-r_motor+yp(1,12), -(h_body/2+h_arm/4+h_motor);... %187
    xp(1,13), l_arm-r_motor+yp(1,13), -(h_body/2+h_arm/4+h_motor);... %188
    xp(1,14), l_arm-r_motor+yp(1,14), -(h_body/2+h_arm/4+h_motor);... %189
    xp(1,15), l_arm-r_motor+yp(1,15), -(h_body/2+h_arm/4+h_motor);... %190
    %propeller3
    -(l_arm-r_motor)+xp(1,1), yp(1,1), -(h_body/2+h_arm/4+h_motor);... %191
    -(l_arm-r_motor)+xp(1,2), yp(1,2), -(h_body/2+h_arm/4+h_motor);...  %192
    -(l_arm-r_motor)+xp(1,3), yp(1,3), -(h_body/2+h_arm/4+h_motor);...  %193
    -(l_arm-r_motor)+xp(1,4), yp(1,4), -(h_body/2+h_arm/4+h_motor);... %194
    -(l_arm-r_motor)+xp(1,5), yp(1,5), -(h_body/2+h_arm/4+h_motor);... %195
    -(l_arm-r_motor)+xp(1,6), yp(1,6), -(h_body/2+h_arm/4+h_motor);... %196
    -(l_arm-r_motor)+xp(1,7), yp(1,7), -(h_body/2+h_arm/4+h_motor);... %197
    -(l_arm-r_motor)+xp(1,8), yp(1,8), -(h_body/2+h_arm/4+h_motor);... %198
    -(l_arm-r_motor)+xp(1,9), yp(1,9), -(h_body/2+h_arm/4+h_motor);... %199
    -(l_arm-r_motor)+xp(1,10), yp(1,10), -(h_body/2+h_arm/4+h_motor);... %200
    -(l_arm-r_motor)+xp(1,11), yp(1,11), -(h_body/2+h_arm/4+h_motor);... %201
    -(l_arm-r_motor)+xp(1,12), yp(1,12), -(h_body/2+h_arm/4+h_motor);... %202
    -(l_arm-r_motor)+xp(1,13), yp(1,13), -(h_body/2+h_arm/4+h_motor);... %203
    -(l_arm-r_motor)+xp(1,14), yp(1,14), -(h_body/2+h_arm/4+h_motor);... %204
    -(l_arm-r_motor)+xp(1,15), yp(1,15), -(h_body/2+h_arm/4+h_motor);... %205
    %propeller 4
    xp(1,1), -(l_arm-r_motor)+yp(1,1), -(h_body/2+h_arm/4+h_motor);... %206 
    xp(1,2), -(l_arm-r_motor)+yp(1,2), -(h_body/2+h_arm/4+h_motor);...  %207   
    xp(1,3), -(l_arm-r_motor)+yp(1,3), -(h_body/2+h_arm/4+h_motor);...  %208  
    xp(1,4), -(l_arm-r_motor)+yp(1,4), -(h_body/2+h_arm/4+h_motor);... %209   
    xp(1,5), -(l_arm-r_motor)+yp(1,5), -(h_body/2+h_arm/4+h_motor);... %210
    xp(1,6), -(l_arm-r_motor)+yp(1,6), -(h_body/2+h_arm/4+h_motor);... %211
    xp(1,7), -(l_arm-r_motor)+yp(1,7), -(h_body/2+h_arm/4+h_motor);... %212
    xp(1,8), -(l_arm-r_motor)+yp(1,8), -(h_body/2+h_arm/4+h_motor);... %213
    xp(1,9), -(l_arm-r_motor)+yp(1,9), -(h_body/2+h_arm/4+h_motor);... %214
    xp(1,10), -(l_arm-r_motor)+yp(1,10), -(h_body/2+h_arm/4+h_motor);... %215
    xp(1,11), -(l_arm-r_motor)+yp(1,11), -(h_body/2+h_arm/4+h_motor);... %216
    xp(1,12), -(l_arm-r_motor)+yp(1,12), -(h_body/2+h_arm/4+h_motor);... %217
    xp(1,13), -(l_arm-r_motor)+yp(1,13), -(h_body/2+h_arm/4+h_motor);... %218
    xp(1,14), -(l_arm-r_motor)+yp(1,14), -(h_body/2+h_arm/4+h_motor);... %219
    xp(1,15), -(l_arm-r_motor)+yp(1,15), -(h_body/2+h_arm/4+h_motor);... %220
    ]';
    

% define faces as a list of vertices numbered above
  F = [...
        %body
        1, 2, 3, 4,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN; ...   
        5, 6, 7, 8,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN; ...
        1, 4, 8, 5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...  
        1, 2, 6, 5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...  
        2, 3, 7, 6,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        3, 4, 8, 7,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        %arm1
        9, 10, 11, 12,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        13, 14, 15, 16,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        9, 10, 14, 13,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        10, 11, 15, 14,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        11, 12, 16, 15,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %arm2
        17, 18, 19, 20,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        21, 22, 23, 24,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        17, 18, 22, 21,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        18, 19, 23, 22,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        19, 20, 24, 23,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %arm3
        25, 26, 27, 28,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        29, 30, 31, 32,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN; ...
        25, 26, 30, 29,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        26, 27, 31, 30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        27, 28, 32, 31,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %arm4
        33, 34, 35, 36,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        37, 38, 39, 40,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        33, 34, 38, 37,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        34, 35, 39, 38,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        35, 36, 40, 39,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %motor1
        41, 42, 57, 56,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+1, 42+1, 57+1, 56+1,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+2, 42+2, 57+2,56+2,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+3, 42+3, 57+3, 56+3,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+4, 42+4, 57+4, 56+4,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+5, 42+5, 57+5, 56+5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+6, 42+6, 57+6, 56+6,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+7, 42+7, 57+7, 56+7,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+8, 42+8, 57+8, 56+8,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+9, 42+9, 57+9, 56+9,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+10, 42+10, 57+10, 56+10,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+11, 42+11, 57+11, 56+11,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+12, 42+12, 57+12, 56+12,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+13, 42+13, 57+13, 56+13,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41, 54, 69, 56,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %motor2
        41+30, 42+30, 57+30, 56+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+1+30, 42+1+30, 57+1+30, 56+1+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+2+30, 42+2+30, 57+2+30, 56+2+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+3+30, 42+3+30, 57+3+30, 56+3+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+4+30, 42+4+30, 57+4+30, 56+4+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+5+30, 42+5+30, 57+5+30, 56+5+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+6+30, 42+6+30, 57+6+30, 56+6+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+7+30, 42+7+30, 57+7+30, 56+7+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+8+30, 42+8+30, 57+8+30, 56+8+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+9+30, 42+9+30, 57+9+30, 56+9+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+10+30, 42+10+30, 57+10+30, 56+10+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+11+30, 42+11+30, 57+11+30, 56+11+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+12+30, 42+12+30, 57+12+30, 56+12+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+13+30, 42+13+30, 57+13+30, 56+13+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+30, 54+30, 69+30, 56+30,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %motor3
        41+60, 42+60, 57+60, 56+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+1+60, 42+1+60, 57+1+60, 56+1+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+2+60, 42+2+60, 57+2+60,56+2+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+3+60, 42+3+60, 57+3+60, 56+3+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+4+60, 42+4+60, 57+4+60, 56+4+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+5+60, 42+5+60, 57+5+60, 56+5+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+6+60, 42+6+60, 57+6+60, 56+6+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+7+60, 42+7+60, 57+7+60, 56+7+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+8+60, 42+8+60, 57+8+60, 56+8+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+9+60, 42+9+60, 57+9+60, 56+9+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+10+60, 42+10+60, 57+10+60, 56+10+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+11+60, 42+11+60, 57+11+60, 56+11+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+12+60, 42+12+60, 57+12+60, 56+12+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+13+60, 42+13+60, 57+13+60, 56+13+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+60, 54+60, 69+60, 56+60,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %motor4
        41+90, 42+90, 57+90, 56+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+1+90, 42+1+90, 57+1+90, 56+1+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+2+90, 42+2+90, 57+2+90,56+2+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+3+90, 42+3+90, 57+3+90, 56+3+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+4+90, 42+4+90, 57+4+90, 56+4+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+5+90, 42+5+90, 57+5+90, 56+5+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+6+90, 42+6+90, 57+6+90, 56+6+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+7+90, 42+7+90, 57+7+90, 56+7+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+8+90, 42+8+90, 57+8+90, 56+8+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+9+90, 42+9+90, 57+9+90, 56+9+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        41+10+90, 42+10+90, 57+10+90, 56+10+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+11+90, 42+11+90, 57+11+90, 56+11+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+12+90, 42+12+90, 57+12+90, 56+12+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+13+90, 42+13+90, 57+13+90, 56+13+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;... 
        41+90, 54+90, 69+90, 56+90,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;...
        %propeller 1
        161,162,163,164,165,166,167,168,169,170,171,172,173,174,175;...
        %propeller 2
        161+15,162+15,163+15,164+15,165+15,166+15,167+15,168+15,169+15,170+15,171+15,172+15,173+15,174+15,175+15;...
        %propeller 3
        161+30,162+30,163+30,164+30,165+30,166+30,167+30,168+30,169+30,170+30,171+30,172+30,173+30,174+30,175+30;...
        %propeller 4
        161+45,162+45,163+45,164+45,165+45,166+45,167+45,168+45,169+45,170+45,171+45,172+45,173+45,174+45,175+45;...
        
    ];


% define colors for each face    
    myred = [1, 0, 0];
    mygreen = [1, 1, 1];
    myblue = [0, 0, 1];
    myyellow = [1, 1, 0];
    mycyan = [0, 1, 1];
    myblack=[0, 0, 0];
    mywhite=[1, 1, 1];
    
    facecolors = [...
        %body
        mywhite;...
        mywhite;...
        mywhite;...
        mywhite;...
        mywhite;...
        mywhite;...
        %arm1
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %arm2
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %arm3
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %arm4
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %motor1
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %motor2
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %motor3
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %motor4
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        myblack;...
        %propeller 1
        myred;...
        %propeller 2
        mycyan;...
        %propeller 3
        myred;...
        %propeller 4
        mycyan;...
    ];
end
  